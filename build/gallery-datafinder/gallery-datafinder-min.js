YUI.add("gallery-datafinder",function(D){function A(F){this._count=A._count;this._uid=A.UID_PREFIX+this._count;A._count++;this._data={};if(D.Lang.isObject(F)){for(var E in F){if(D.Object.hasKey(F,E)){this._data[E]=F[E];}}}}A._count=0;A.UID_PREFIX="yui-rec";A.prototype={_count:null,_uid:null,_data:null,getCount:function(){return this._count;},getId:function(){return this._uid;},getData:function(E){if(D.Lang.isString(E)){return this._data[E];}else{return this._data;}},setData:function(E){if(D.Lang.isObject(E)){var F={};if(E.key&&E.value){F[E.key]=E.value;E=F;}for(F in E){if(D.Object.hasKey(E,F)&&this._data[F]){this._data[F]=E[F];}}return this._data;}return null;}};D.Record=A;function B(E){this._uid=B.UID_PREFIX+B._count;B._count++;this._records=[];if(E){if(D.Lang.isArray(E)){this.addRecords(E);}else{if(D.Lang.isObject(E)){this.addRecord(E);}}}}D.mix(B,{NAME:"recordset",_count:0,UID_PREFIX:"yui-rs"});D.extend(B,D.Base,{_uid:null,initialize:function(){this.publish("");},_addRecord:function(G,F){var E=new D.Record(G);if(D.Lang.isNumber(F)&&(F>-1)){this._records.splice(F,0,E);}else{this._records.push(E);}return E;},_setRecord:function(F,E){if(!D.Lang.isNumber(E)||E<0){E=this._records.length;}return(this._records[E]=new D.Record(F));},_deleteRecord:function(F,E){if(!D.Lang.isNumber(E)||(E<0)){E=1;}this._records.splice(F,E);},getId:function(){return this._uid;},getLength:function(){return this._records.length;},getRecord:function(F){var G,E;if(F instanceof D.Record){for(G=0,E=this._records.length;G<E;G++){if(this._records[G]&&(this._records[G].getId()==F.getId())){return F;}}}else{if(D.Lang.isNumber(F)){if(F>-1&&(F<this._records.length)){return this._records[F];}}else{if(D.Lang.isString(F)){for(G=0,E=this._records.length;G<E;G++){if(this._records[G]&&(this._records[G].getId()==F)){return this._records[G];}}}}}return null;},getRecords:function(F,E){if(!D.Lang.isNumber(F)){return this._records;}if(!D.Lang.isNumber(E)){return this._records.slice(F);}return this._records.slice(F,F+E);},hasRecords:function(F,E){for(var G=0;G<E;++G){if(typeof this._records[G]===undefined){return false;}}return true;},getRecordIndex:function(E){if(E){for(var F=this._records.length-1;F>-1;F--){if(this._records[F]&&E.getId()===this._records[F].getId()){return F;}}}return null;},addRecord:function(G,F){if(D.Lang.isObject(G)){var E=this._addRecord(G,F);return E;}return null;},addRecords:function(J,H){if(D.Lang.isArray(J)){var K=[],F,I,E,G;H=D.Lang.isNumber(H)?H:this._records.length;F=H;for(I=0,E=J.length;I<E;++I){if(D.Lang.isObject(J[I])){G=this._addRecord(J[I],F++);K.push(G);}}return K;}else{if(D.Lang.isObject(J)){G=this._addRecord(J);return G;}}return null;},setRecord:function(G,F){if(D.Lang.isObject(G)){var E=this._setRecord(G,F);return E;}return null;},setRecords:function(K,H){var F=D.Lang.isArray(K)?K:[K],J=[],I=0,E=F.length,G=0;H=parseInt(H,10)|0;for(;I<E;++I){if(typeof F[I]=="object"&&F[I]){J[G++]=this._records[H+I]=new D.Record(F[I]);}}if(F.length&&!J.length){}return J.length>1?J:J[0];},updateRecord:function(E,G){E=this.getRecord(E);if(E&&D.Lang.isObject(G)){var H=D.Object(E.getData()),F=E.setData(G);return E;}return null;},updateRecordValue:function(E,F,G){E=this.getRecord(E);if(E){var I=null,H=E.getData(F);if(H&&D.Lang.isObject(H)){I=D.Object(H);}else{I=H;}E.setData({key:F,value:G});}else{}},replaceRecords:function(E){this.reset();return this.addRecords(E);},sortRecords:function(E,G,F){return this._records.sort(function(I,H){return E(I,H,G,F);});},reverseRecords:function(){return this._records.reverse();},deleteRecord:function(E){if(D.Lang.isNumber(E)&&(E>-1)&&(E<this.getLength())){var F=D.Object(this.getRecord(E).getData());this._deleteRecord(E);return F;}else{return null;}},deleteRecords:function(H,F){if(!D.Lang.isNumber(F)){F=1;}if(D.Lang.isNumber(H)&&(H>-1)&&(H<this.getLength())){var J=this.getRecords(H,F),G=[],I=0,E=J.length;for(;I<E;I++){G[G.length]=D.Object(J[I]);}this._deleteRecord(H,F);return G;}else{return null;}},reset:function(){this._records=[];}});D.RecordSet=B;function C(){C.superclass.constructor.apply(this,arguments);}D.mix(C,{NAME:"datafinder",ATTRS:{dataSource:{validator:function(E){return this._validateDataSource(E);}}}});D.extend(C,D.Base,{_params:null,_validateDataSource:function(E){if(E instanceof D.DataSource.Local){return true;}return false;},initializer:function(){this.publish("success");this.publish("failure");this._params={};},generateQuery:function(G){var F="",E;for(E in G){if(D.Object.hasKey(G,E)){F+="&"+E+"="+G[E];}}return F;},setParam:function(E,F){this._params[E]=F;},setParams:function(F){for(var E in F){if(D.Object.hasKey(F,E)){this._params[E]=F[E];}}},clearParam:function(E){if(D.Object.hasKey(this._params,E)){delete this._params[E];}},fetch:function(){var F=this.get("dataSource"),E=this.generateQuery(this._params);F.sendRequest(E,{success:function(I){var H=I.callback.argument,G;if(I.response&&I.response.results&&!I.response.error){G=new D.RecordSet();G.setRecords(I.response.results,0);H.fire("success",{request:I.request,recordset:G,meta:I.response.meta});}else{H.fire("failure",I);}},failure:function(H){var G=H.callback.argument;G.fire("failure",H);},argument:this});}});D.DataFinder=C;},"@VERSION@",{requires:["base","datasource-base"]});